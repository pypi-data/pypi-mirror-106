import{aR as Me,fH as m,cl as D,f9 as A,dy as ce,eR as re,fG as h}from"../../../../common/three.module-ece1dfd3.js";const le={type:"change"},_={type:"start"},H={type:"end"};class De extends Me{constructor(U,S){super();S===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),S===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=U,this.domElement=S,this.enabled=!0,this.target=new m,this.minDistance=0,this.maxDistance=Infinity,this.minZoom=0,this.maxZoom=Infinity,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-Infinity,this.maxAzimuthAngle=Infinity,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:D.ROTATE,MIDDLE:D.DOLLY,RIGHT:D.PAN},this.touches={ONE:A.ROTATE,TWO:A.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return i.phi},this.getAzimuthalAngle=function(){return i.theta},this.listenToKeyEvents=function(t){t.addEventListener("keydown",te),this._domElementKeyEvents=t},this.saveState=function(){e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=function(){e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(le),e.update(),a=n.NONE},this.update=function(){const t=new m,o=new ce().setFromUnitVectors(U.up,new m(0,1,0)),s=o.clone().invert(),c=new m,E=new ce,M=2*Math.PI;return function(){const ie=e.object.position;t.copy(ie).sub(e.target),t.applyQuaternion(o),i.setFromVector3(t),e.autoRotate&&a===n.NONE&&x(ue()),e.enableDamping?(i.theta+=r.theta*e.dampingFactor,i.phi+=r.phi*e.dampingFactor):(i.theta+=r.theta,i.phi+=r.phi);let l=e.minAzimuthAngle,u=e.maxAzimuthAngle;return isFinite(l)&&isFinite(u)&&(l<-Math.PI?l+=M:l>Math.PI&&(l-=M),u<-Math.PI?u+=M:u>Math.PI&&(u-=M),l<=u?i.theta=Math.max(l,Math.min(u,i.theta)):i.theta=i.theta>(l+u)/2?Math.max(l,i.theta):Math.min(u,i.theta)),i.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,i.phi)),i.makeSafe(),i.radius*=N,i.radius=Math.max(e.minDistance,Math.min(e.maxDistance,i.radius)),e.enableDamping===!0?e.target.addScaledVector(g,e.dampingFactor):e.target.add(g),t.setFromSpherical(i),t.applyQuaternion(s),ie.copy(e.target).add(t),e.object.lookAt(e.target),e.enableDamping===!0?(r.theta*=1-e.dampingFactor,r.phi*=1-e.dampingFactor,g.multiplyScalar(1-e.dampingFactor)):(r.set(0,0,0),g.set(0,0,0)),N=1,R||c.distanceToSquared(e.object.position)>z||8*(1-E.dot(e.object.quaternion))>z?(e.dispatchEvent(le),c.copy(e.object.position),E.copy(e.object.quaternion),R=!1,!0):!1}}(),this.dispose=function(){e.domElement.removeEventListener("contextmenu",se),e.domElement.removeEventListener("pointerdown",$),e.domElement.removeEventListener("wheel",ee),e.domElement.removeEventListener("touchstart",oe),e.domElement.removeEventListener("touchend",ae),e.domElement.removeEventListener("touchmove",ne),e.domElement.ownerDocument.removeEventListener("pointermove",C),e.domElement.ownerDocument.removeEventListener("pointerup",I),e._domElementKeyEvents!==null&&e._domElementKeyEvents.removeEventListener("keydown",te)};const e=this,n={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=n.NONE;const z=1e-6,i=new re,r=new re;let N=1;const g=new m;let R=!1;const p=new h,f=new h,y=new h,d=new h,b=new h,T=new h,O=new h,P=new h,L=new h;function ue(){return 2*Math.PI/60/60*e.autoRotateSpeed}function j(){return Math.pow(.95,e.zoomSpeed)}function x(t){r.theta-=t}function X(t){r.phi-=t}const Z=function(){const t=new m;return function(s,c){t.setFromMatrixColumn(c,0),t.multiplyScalar(-s),g.add(t)}}(),F=function(){const t=new m;return function(s,c){e.screenSpacePanning===!0?t.setFromMatrixColumn(c,1):(t.setFromMatrixColumn(c,0),t.crossVectors(e.object.up,t)),t.multiplyScalar(s),g.add(t)}}(),w=function(){const t=new m;return function(s,c){const E=e.domElement;if(e.object.isPerspectiveCamera){const M=e.object.position;t.copy(M).sub(e.target);let k=t.length();k*=Math.tan(e.object.fov/2*Math.PI/180),Z(2*s*k/E.clientHeight,e.object.matrix),F(2*c*k/E.clientHeight,e.object.matrix)}else e.object.isOrthographicCamera?(Z(s*(e.object.right-e.object.left)/e.object.zoom/E.clientWidth,e.object.matrix),F(c*(e.object.top-e.object.bottom)/e.object.zoom/E.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}}();function Y(t){e.object.isPerspectiveCamera?N/=t:e.object.isOrthographicCamera?(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom*t)),e.object.updateProjectionMatrix(),R=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function v(t){e.object.isPerspectiveCamera?N*=t:e.object.isOrthographicCamera?(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/t)),e.object.updateProjectionMatrix(),R=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function K(t){p.set(t.clientX,t.clientY)}function he(t){O.set(t.clientX,t.clientY)}function V(t){d.set(t.clientX,t.clientY)}function me(t){f.set(t.clientX,t.clientY),y.subVectors(f,p).multiplyScalar(e.rotateSpeed);const o=e.domElement;x(2*Math.PI*y.x/o.clientHeight),X(2*Math.PI*y.y/o.clientHeight),p.copy(f),e.update()}function pe(t){P.set(t.clientX,t.clientY),L.subVectors(P,O),L.y>0?Y(j()):L.y<0&&v(j()),O.copy(P),e.update()}function fe(t){b.set(t.clientX,t.clientY),T.subVectors(b,d).multiplyScalar(e.panSpeed),w(T.x,T.y),d.copy(b),e.update()}function de(t){t.deltaY<0?v(j()):t.deltaY>0&&Y(j()),e.update()}function be(t){let o=!1;switch(t.code){case e.keys.UP:w(0,e.keyPanSpeed),o=!0;break;case e.keys.BOTTOM:w(0,-e.keyPanSpeed),o=!0;break;case e.keys.LEFT:w(e.keyPanSpeed,0),o=!0;break;case e.keys.RIGHT:w(-e.keyPanSpeed,0),o=!0;break}o&&(t.preventDefault(),e.update())}function G(t){if(t.touches.length==1)p.set(t.touches[0].pageX,t.touches[0].pageY);else{const o=.5*(t.touches[0].pageX+t.touches[1].pageX),s=.5*(t.touches[0].pageY+t.touches[1].pageY);p.set(o,s)}}function W(t){if(t.touches.length==1)d.set(t.touches[0].pageX,t.touches[0].pageY);else{const o=.5*(t.touches[0].pageX+t.touches[1].pageX),s=.5*(t.touches[0].pageY+t.touches[1].pageY);d.set(o,s)}}function q(t){const o=t.touches[0].pageX-t.touches[1].pageX,s=t.touches[0].pageY-t.touches[1].pageY,c=Math.sqrt(o*o+s*s);O.set(0,c)}function Ee(t){e.enableZoom&&q(t),e.enablePan&&W(t)}function ge(t){e.enableZoom&&q(t),e.enableRotate&&G(t)}function B(t){if(t.touches.length==1)f.set(t.touches[0].pageX,t.touches[0].pageY);else{const s=.5*(t.touches[0].pageX+t.touches[1].pageX),c=.5*(t.touches[0].pageY+t.touches[1].pageY);f.set(s,c)}y.subVectors(f,p).multiplyScalar(e.rotateSpeed);const o=e.domElement;x(2*Math.PI*y.x/o.clientHeight),X(2*Math.PI*y.y/o.clientHeight),p.copy(f)}function Q(t){if(t.touches.length==1)b.set(t.touches[0].pageX,t.touches[0].pageY);else{const o=.5*(t.touches[0].pageX+t.touches[1].pageX),s=.5*(t.touches[0].pageY+t.touches[1].pageY);b.set(o,s)}T.subVectors(b,d).multiplyScalar(e.panSpeed),w(T.x,T.y),d.copy(b)}function J(t){const o=t.touches[0].pageX-t.touches[1].pageX,s=t.touches[0].pageY-t.touches[1].pageY,c=Math.sqrt(o*o+s*s);P.set(0,c),L.set(0,Math.pow(P.y/O.y,e.zoomSpeed)),Y(L.y),O.copy(P)}function ye(t){e.enableZoom&&J(t),e.enablePan&&Q(t)}function Te(t){e.enableZoom&&J(t),e.enableRotate&&B(t)}function $(t){if(e.enabled!==!1)switch(t.pointerType){case"mouse":case"pen":Oe(t);break}}function C(t){if(e.enabled!==!1)switch(t.pointerType){case"mouse":case"pen":Pe(t);break}}function I(t){switch(t.pointerType){case"mouse":case"pen":we();break}}function Oe(t){t.preventDefault(),e.domElement.focus?e.domElement.focus():window.focus();let o;switch(t.button){case 0:o=e.mouseButtons.LEFT;break;case 1:o=e.mouseButtons.MIDDLE;break;case 2:o=e.mouseButtons.RIGHT;break;default:o=-1}switch(o){case D.DOLLY:if(e.enableZoom===!1)return;he(t),a=n.DOLLY;break;case D.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enablePan===!1)return;V(t),a=n.PAN}else{if(e.enableRotate===!1)return;K(t),a=n.ROTATE}break;case D.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enableRotate===!1)return;K(t),a=n.ROTATE}else{if(e.enablePan===!1)return;V(t),a=n.PAN}break;default:a=n.NONE}a!==n.NONE&&(e.domElement.ownerDocument.addEventListener("pointermove",C),e.domElement.ownerDocument.addEventListener("pointerup",I),e.dispatchEvent(_))}function Pe(t){if(e.enabled!==!1)switch(t.preventDefault(),a){case n.ROTATE:if(e.enableRotate===!1)return;me(t);break;case n.DOLLY:if(e.enableZoom===!1)return;pe(t);break;case n.PAN:if(e.enablePan===!1)return;fe(t);break}}function we(t){e.domElement.ownerDocument.removeEventListener("pointermove",C),e.domElement.ownerDocument.removeEventListener("pointerup",I),e.enabled!==!1&&(e.dispatchEvent(H),a=n.NONE)}function ee(t){e.enabled===!1||e.enableZoom===!1||a!==n.NONE&&a!==n.ROTATE||(t.preventDefault(),e.dispatchEvent(_),de(t),e.dispatchEvent(H))}function te(t){e.enabled===!1||e.enablePan===!1||be(t)}function oe(t){if(e.enabled!==!1){switch(t.preventDefault(),t.touches.length){case 1:switch(e.touches.ONE){case A.ROTATE:if(e.enableRotate===!1)return;G(t),a=n.TOUCH_ROTATE;break;case A.PAN:if(e.enablePan===!1)return;W(t),a=n.TOUCH_PAN;break;default:a=n.NONE}break;case 2:switch(e.touches.TWO){case A.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;Ee(t),a=n.TOUCH_DOLLY_PAN;break;case A.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;ge(t),a=n.TOUCH_DOLLY_ROTATE;break;default:a=n.NONE}break;default:a=n.NONE}a!==n.NONE&&e.dispatchEvent(_)}}function ne(t){if(e.enabled!==!1)switch(t.preventDefault(),a){case n.TOUCH_ROTATE:if(e.enableRotate===!1)return;B(t),e.update();break;case n.TOUCH_PAN:if(e.enablePan===!1)return;Q(t),e.update();break;case n.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;ye(t),e.update();break;case n.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;Te(t),e.update();break;default:a=n.NONE}}function ae(t){e.enabled!==!1&&(e.dispatchEvent(H),a=n.NONE)}function se(t){e.enabled!==!1&&t.preventDefault()}e.domElement.addEventListener("contextmenu",se),e.domElement.addEventListener("pointerdown",$),e.domElement.addEventListener("wheel",ee,{passive:!1}),e.domElement.addEventListener("touchstart",oe,{passive:!1}),e.domElement.addEventListener("touchend",ae),e.domElement.addEventListener("touchmove",ne,{passive:!1}),this.update()}}export{De as OrbitControls};
