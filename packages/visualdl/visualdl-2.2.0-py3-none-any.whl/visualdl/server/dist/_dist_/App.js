import j from"../__snowpack__/env.js";import.meta.env=j;import e,{Suspense as w,useCallback as b,useEffect as s,useMemo as v}from"../web_modules/react.js";import{Redirect as R,Route as c,BrowserRouter as x,Switch as y,useLocation as N}from"../web_modules/react-router-dom.js";import{THEME as T,matchMedia as u}from"./utils/theme.js";import{actions as C,selectors as S}from"./store/index.js";import{headerHeight as d,position as k,size as A,zIndexes as P}from"./utils/style.js";import{useDispatch as B,useSelector as I}from"../web_modules/react-redux.js";import L from"./components/ErrorBoundary.js";import p from"./pages/error.js";import{Helmet as H}from"../web_modules/react-helmet.js";import f from"../web_modules/nprogress.js";import M from"./components/Navbar.js";import{SWRConfig as O}from"../web_modules/swr.js";import{ToastContainer as z}from"../web_modules/react-toastify.js";import{fetcher as D}from"./utils/fetch.js";import h from"./routes/index.js";import E from"../web_modules/styled-components.js";import{useTranslation as U}from"../web_modules/react-i18next.js";const _=import.meta.env.SNOWPACK_PUBLIC_BASE_URI,V=E.main.withConfig({displayName:"App__Main",componentId:"n063fb-0"})(["padding-top:",";"],d),W=E.header.withConfig({displayName:"App__Header",componentId:"n063fb-1"})(["z-index:",";"," ",""],P.header,A(d,"100%"),k("fixed",0,0,null,0)),l=h.find(t=>t.default),K=h.reduce((t,r)=>(r.children?t.push(...r.children):t.push(r),t),[]),F=()=>(s(()=>(f.start(),()=>{f.done()}),[]),null),$=()=>{const t=N();return s(()=>{window._hmt.push(["_trackPageview",_+t.pathname])},[t.pathname]),null},q=()=>{var t;const{t:r,i18n:o}=U("errors"),g=v(()=>o.language?o.dir(o.language):"",[o]),m=B(),i=I(S.theme.selected),a=b(n=>{i==="auto"&&m(C.theme.setTheme(n.matches?"dark":"light"))},[m,i]);return s(()=>{if(!T)return u.addEventListener("change",a),()=>{u.removeEventListener("change",a)}},[a]),e.createElement("div",{className:"app"},e.createElement(H,{defaultTitle:"VisualDL",titleTemplate:"%s - VisualDL"},e.createElement("html",{lang:o.language,dir:g})),e.createElement(O,{value:{fetcher:D,revalidateOnFocus:!1,revalidateOnReconnect:!1}},e.createElement(V,null,e.createElement(x,{basename:_||"/"},e.createElement($,null),e.createElement(W,null,e.createElement(M,null)),e.createElement(L,{fallback:e.createElement(p,null)},e.createElement(w,{fallback:e.createElement(F,null)},e.createElement(y,null,e.createElement(R,{exact:!0,from:"/",to:(t=l==null?void 0:l.path)!==null&&t!==void 0?t:"/index"}),K.map(n=>e.createElement(c,{key:n.id,path:n.path,component:n.component})),e.createElement(c,{path:"*"},e.createElement(p,{title:r("errors:page-not-found")}))))))),e.createElement(z,null)))};export default q;
