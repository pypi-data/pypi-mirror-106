import R,{useCallback as H,useEffect as o,useRef as s,useState as N}from"../../../../web_modules/react.js";import{useDrag as Y,useDrop as k}from"../../../../web_modules/react-dnd.js";import{DND_TYPE as T}from"../../../resource/hyper-parameter/index.js";import{Dragger as B}from"../../Table.js";import{Th as C}from"../../Table.js";const P=({id:e,draggable:g,onDragStart:u,onDragEnd:a,onChangeDropSide:i,onDrop:c,className:x,style:y,children:D})=>{const f=s(null),[{isDragging:b},E,I]=Y(()=>({type:T,item:{id:e!=null?e:""},options:{dropEffect:"move"},previewOptions:{offsetX:8,offsetY:25},collect:t=>({isDragging:t.isDragging()})})),m=s(u);o(()=>{m.current=u},[u]);const p=s(a);o(()=>{p.current=a},[a]),o(()=>{if(b){var t;(t=m.current)===null||t===void 0||t.call(m,e!=null?e:"")}else{var l;(l=p.current)===null||l===void 0||l.call(p,e!=null?e:"")}},[e,b]);const[r,j]=N(null),v=H(()=>{r&&(c==null||c(e!=null?e:"",r))},[r,e,c]),h=s(v);o(()=>{h.current=v},[v]);const[{handlerId:O},X]=k(()=>({accept:T,collect:t=>({handlerId:t.getHandlerId()}),canDrop:()=>!!g,hover:(t,l)=>{if(!f.current||!l.canDrop())return;const n=f.current.getBoundingClientRect();if(n){const F=(n.right-n.left)/2,w=l.getClientOffset();w&&(w.x-n.left<F?j("before"):j("after"))}},drop:t=>(h.current(),t)})),d=s(i);return o(()=>{d.current=i},[i]),o(()=>{if(r&&e){var t;(t=d.current)===null||t===void 0||t.call(d,e,r)}},[r,e]),I(X(f)),R.createElement(C,{ref:f,"data-handler-id":O,className:x,style:y},g?R.createElement(B,{ref:E}):null,D)};export default P;
