import H from"../../__snowpack__/env.js";import.meta.env=H;function E(){return E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},E.apply(this,arguments)}function V(e,t){if(e==null)return{};var n=z(e,t),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)r=i[o],!(t.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(n[r]=e[r]))}return n}function z(e,t){if(e==null)return{};var n={},r=Object.keys(e),o,i;for(i=0;i<r.length;i++)o=r[i],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?P(Object(n),!0).forEach(function(r){Y(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}import{Link as F,useLocation as X}from"../../web_modules/react-router-dom.js";import a,{useCallback as G,useEffect as J,useMemo as b,useState as Q}from"../../web_modules/react.js";import{border as Z,borderRadius as $,rem as m,size as C,transitionProps as _,triangle as ee}from"../utils/style.js";import x from"./Icon.js";import te from"./Language.js";import ne from"./ThemeToggle.js";import S from"../../web_modules/@tippyjs/react.js";import re from"../utils/event.js";import{getApiToken as ae}from"../utils/fetch.js";import oe from"../assets/images/logo.svg.proxy.js";import L from"../../web_modules/query-string.js";import g from"../../web_modules/styled-components.js";import ie from"../hooks/useClassNames.js";import le from"../hooks/useComponents.js";import{useTranslation as ce}from"../../web_modules/react-i18next.js";const A=import.meta.env.SNOWPACK_PUBLIC_BASE_URI,se=import.meta.env.SNOWPACK_PUBLIC_PATH,T=import.meta.env.SNOWPACK_PUBLIC_API_TOKEN_KEY,U=6,K=e=>{const t=[];return e.forEach(n=>{n.children?t.push(...K(n.children)):t.push(n)}),t};function B(e){if(!T)return e;const t=L.parseUrl(e);return L.stringifyUrl(s(s({},t),{},{query:s(s({},t.query),{},{[T]:ae()})}))}const me=g.nav.withConfig({displayName:"Navbar__Nav",componentId:"vunvj5-0"})(["background-color:var(--navbar-background-color);color:var(--navbar-text-color);"," padding:0 ",";display:flex;justify-content:space-between;align-items:stretch;"," > .left{display:flex;justify-content:flex-start;align-items:center;}> .right{display:flex;justify-content:flex-end;align-items:center;margin-right:-",";}"],C("100%"),m(20),_(["background-color","color"]),m(20)),pe=g.a.withConfig({displayName:"Navbar__Logo",componentId:"vunvj5-1"})(["font-size:",";font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;margin-right:",";> img{"," vertical-align:middle;margin-right:",";}> span{vertical-align:middle;}"],m(20),m(40),C(m(31),m(98)),m(8)),h=g.div.withConfig({displayName:"Navbar__NavItem",componentId:"vunvj5-2"})(["height:100%;display:inline-flex;justify-content:center;align-items:center;background-color:var(--navbar-background-color);cursor:pointer;"," &:hover{background-color:var(--navbar-hover-background-color);}&.nav-item{padding:0 ",";}.nav-link{display:inline-block;width:100%;height:100%;display:inline-flex;justify-content:center;align-items:center;}.nav-text{margin:",";padding:"," 0 ",";"," "," text-transform:uppercase;&.dropdown-icon{&::after{content:'';display:inline-block;width:0;height:0;margin-left:0.5rem;vertical-align:middle;","}}}"],_("background-color"),m(20),m(20),m(10),m(7),e=>Z("bottom",m(3),"solid",e.active?"var(--navbar-highlight-color)":"transparent"),_("border-bottom"),ee({pointingDirection:"bottom",width:m(8),height:m(5),foregroundColor:"currentColor"})),W=g.div.withConfig({displayName:"Navbar__SubNavWrapper",componentId:"vunvj5-3"})(["overflow:hidden;border-radius:",";"],$),ue=g.div.withConfig({displayName:"Navbar__NavItemChild",componentId:"vunvj5-4"})(["display:block;line-height:3em;&,&:visited{color:",";}&:hover{background-color:var(--background-focused-color);}> a{display:block;padding:0 ",";}"],e=>e.active?"var(--primary-color)":"var(--text-color)",m(20)),D=e=>{let{to:t,children:n}=e,r=V(e,["to","children"]);return a.createElement(F,E({to:t?B(t):""},r),n)},O=a.forwardRef(({path:e,active:t,showDropdownIcon:n,children:r},o)=>{const i=ie("nav-text",{"dropdown-icon":n},[n]);return e?a.createElement(h,{active:t,ref:o},a.createElement(D,{to:e,className:"nav-link"},a.createElement("span",{className:i},r))):a.createElement(h,{active:t,ref:o},a.createElement("span",{className:i},r))});O.displayName="NavbarItem";const M=({menu:e,active:t,path:n,showDropdownIcon:r,children:o})=>a.createElement(S,{placement:"bottom-start",animation:"shift-away-subtle",interactive:!0,arrow:!1,offset:[0,0],hideOnClick:!1,role:"menu",content:a.createElement(W,null,e.map(i=>a.createElement(ue,{active:i.active,key:i.id},a.createElement(D,{to:i.path},i.name))))},a.createElement(O,{active:t||!1,path:n,showDropdownIcon:r},o)),de=()=>{const{t:e,i18n:t}=ce("common"),{pathname:n}=X(),r=G(()=>{const l=t.language,c=(t.options.supportedLngs||[]).filter(f=>f!=="cimode"),p=c.indexOf(l),d=p<0||p>=c.length-1?c[0]:c[p+1];t.changeLanguage(d)},[t]),o=b(()=>n.replace(A,""),[n]),[i]=le(),w=b(()=>i.slice(0,U),[i]),I=b(()=>K(i.slice(U)),[i]),k=b(()=>I.map(l=>s(s({},l),{},{active:o===l.path})),[o,I]),[R,q]=Q([]);return J(()=>{q(l=>w.map(c=>{var p;const d=(p=c.children)===null||p===void 0?void 0:p.map(u=>s(s({},u),{},{active:u.path===o}));if(c.children&&!c.path){const u=c.children.find(v=>v.path===o);if(u)return s(s({},c),{},{cid:u.id,name:u.name,path:o,active:!0,children:d});{const v=l.find(j=>j.id===c.id);if(v){var f,y,N;return s(s(s({},c),v),{},{name:(f=(y=c.children)===null||y===void 0||(N=y.find(j=>j.id===v.cid))===null||N===void 0?void 0:N.name)!==null&&f!==void 0?f:c.name,active:!1,children:d})}}}return s(s({},c),{},{active:o===c.path,children:d})}))},[w,o]),a.createElement(me,null,a.createElement("div",{className:"left"},a.createElement(pe,{href:B(A+"/index")},a.createElement("img",{alt:"PaddlePaddle",src:se+oe}),a.createElement("span",null,"VisualDL")),R.map(l=>l.children?a.createElement(M,{menu:l.children,active:l.active,path:l.path,key:l.active?`${l.id}-activated`:l.id},l.name):a.createElement(O,{active:l.active,path:l.path,key:l.id},l.name)),k.length?a.createElement(M,{menu:k,showDropdownIcon:!0},e("common:more")):null),a.createElement("div",{className:"right"},a.createElement(S,{placement:"bottom-end",animation:"shift-away-subtle",interactive:!0,arrow:!1,offset:[18,0],hideOnClick:!1,role:"menu",content:a.createElement(W,null,a.createElement(ne,null))},a.createElement(h,{className:"nav-item"},a.createElement(x,{type:"theme"}))),a.createElement(h,{className:"nav-item",onClick:r},a.createElement(te,null)),a.createElement(h,{className:"nav-item",onClick:()=>re.emit("refresh")},a.createElement(x,{type:"refresh"}))))};export default de;
