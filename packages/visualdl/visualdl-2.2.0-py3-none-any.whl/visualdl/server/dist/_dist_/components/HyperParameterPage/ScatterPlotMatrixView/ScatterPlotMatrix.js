function O(){return O=Object.assign||function(r){for(var l=1;l<arguments.length;l++){var a=arguments[l];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])}return r},O.apply(this,arguments)}function _(r,l){var a=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);l&&(n=n.filter(function(m){return Object.getOwnPropertyDescriptor(r,m).enumerable})),a.push.apply(a,n)}return a}function C(r){for(var l=1;l<arguments.length;l++){var a=arguments[l]!=null?arguments[l]:{};l%2?_(Object(a),!0).forEach(function(n){F(r,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(a,n))})}return r}function F(r,l,a){return l in r?Object.defineProperty(r,l,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[l]=a,r}import o,{useCallback as f,useMemo as u,useRef as U,useState as g}from"../../../../web_modules/react.js";import M from"./ScatterChart/ScatterChart.js";import{ScaleMethod as x}from"../../../resource/hyper-parameter/index.js";import N from"../ScaleMethodSelect.js";import V from"./ScatterChart/index.js";import{rem as h}from"../../../utils/style.js";import $ from"../../../../web_modules/styled-components.js";const K=150,Z=$.div.withConfig({displayName:"ScatterPlotMatrix__Container",componentId:"sc-12jt4wx-0"})(["overflow-x:auto;display:flex;flex-direction:column;--label-size:1em;--chart-size:",";.row{display:flex;flex-direction:row;}.metrics{display:block;text-align:center;font-weight:700;width:var(--label-size);height:var(--chart-size);line-height:var(--label-size);> span{display:inline-block;width:var(--chart-size);height:var(--label-size);transform:rotate(270deg) translate(calc(-1 * var(--chart-size)),0);transform-origin:left top;}}.hparams{display:block;width:var(--chart-size);text-align:center;flex:none;> span{height:var(--label-size);line-height:var(--label-size);}}.metrics-hparams{width:calc("," + ","px);}.row-scale-method-selector{margin:"," 0 "," calc("," + var(--label-size));height:1em;}.column-scale-method-selector{margin-top:",";}"],h(K+M.MARGIN_WITHOUT_LABEL*2),h(14),M.MARGIN_LEFT_WITH_LABEL-M.MARGIN_WITHOUT_LABEL,h(10),h(10),h(10),h(10)),q=({indicators:r,data:l,colors:a,onHover:n,onSelect:m})=>{const P=U({colors:a}),p=u(()=>r.filter(t=>t.group==="metrics"),[r]),i=u(()=>r.filter(t=>t.group==="hparams"),[r]),[z,I]=g(null),[A,L]=g(null),[S,B]=g(null),[v,R]=g(null),T=f(t=>{I(t),n==null||n(t)},[n]),D=f(t=>{L(t),m==null||m(t)},[m]),k=f((t,e,s)=>{B(s),R(s!=null?[t,e]:null)},[]),W=f((t,e)=>v&&v[0]===t&&v[1]===e?void 0:S,[S,v]),[b,G]=g(new WeakMap),y=u(()=>p.map(t=>{var e;return t.type==="continuous"?(e=b.get(t))!==null&&e!==void 0?e:x.LINEAR:null}),[p,b]),w=u(()=>i.map(t=>{var e;return t.type==="continuous"?(e=b.get(t))!==null&&e!==void 0?e:x.LINEAR:null}),[i,b]),j=f((t,e)=>{G(s=>{const c=new WeakMap;return r.forEach(d=>{s.has(d)&&c.set(d,s.get(d))}),c.set(t,e),c})},[r]),E=u(()=>p.map(t=>i.map(e=>({data:l.map(s=>[s[e.group][e.name],s[t.group][t.name]]),type:[e.type,t.type]}))),[l,i,p]),H=u(()=>E.map((t,e)=>t.map((s,c)=>({data:s,options:C(C({},P.current),{},{labelVisible:[e===E.length-1,c===0]}),scaleMethods:[w[c],y[e]]}))),[E,w,y]);return o.createElement(Z,null,H.map((t,e)=>o.createElement(o.Fragment,{key:e},o.createElement("div",{className:"row-scale-method-selector"},y[e]!=null?o.createElement(N,{scaleMethod:y[e],onChange:s=>j(p[e],s)}):null),o.createElement("div",{className:"row"},o.createElement("div",{className:"metrics"},o.createElement("span",null,p[e].name)),t.map((s,c)=>o.createElement("div",{className:"cell",key:c},o.createElement(V,O({},s,{colors:a,hover:z,select:A,brush:W(e,c),onHover:T,onSelect:D,onBrush:d=>k(e,c,d)}))))))),o.createElement("div",{className:"row"},o.createElement("span",{className:"metrics-hparams"}),i.map((t,e)=>o.createElement("div",{className:"hparams",key:e},o.createElement("span",null,t.name),o.createElement("div",{className:"column-scale-method-selector"},w[e]!=null?o.createElement(N,{direction:"top",scaleMethod:w[e],onChange:s=>j(i[e],s)}):null)))))};export default q;
