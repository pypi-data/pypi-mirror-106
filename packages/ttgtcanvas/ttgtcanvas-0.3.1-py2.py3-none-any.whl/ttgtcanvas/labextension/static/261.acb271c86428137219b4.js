(self.webpackChunkttgtcanvas=self.webpackChunkttgtcanvas||[]).push([[261],{1568:(e,t,n)=>{e.exports=n(1367),e.exports.version=n(306).version},6261:(e,t,n)=>{var i=n(1568),r=n(1337);e.exports={id:"ttgtcanvas:plugin",requires:[r.IJupyterWidgetRegistry],activate:function(e,t){t.registerWidget({name:"ttgtcanvas",version:i.version,exports:i})},autoStart:!0}},7795:(e,t,n)=>{var i=n(1337),r=n(5431),o=n(4827);const{default:a}=n(8524),s=new a({concurrency:1});n(4840);var l=i.DOMWidgetModel.extend({defaults:r.extend(i.DOMWidgetModel.prototype.defaults(),{_model_name:"MazeModel",_view_name:"MazeView",_model_module:"ttgtcanvas",_view_module:"ttgtcanvas",_model_module_version:"0.3.1",_view_module_version:"0.3.1",current_call:"{}",method_return:"{}"})});const d=function(e,t,n,i,r){var a=new o.RegularPolygon({x:i,y:r-4,sides:3,radius:12,fill:"green",stroke:"#555D50",strokeWidth:3,rotation:90});let s=new o.Line({points:[i-8,r-18,i-8,r+16],fill:"#555D50",stroke:"#555D50",strokeWidth:5}),l=new o.Group({name:`flag-${t}-${n}`});l.add(a,s),e.add(l)},c=function(e,t,n,i,r,a,s){let l=.6*a,d=new o.Circle({radius:l,x:i,y:r,fill:"yellow",stroke:"orange",strokeWidth:5,name:`beeper-${t}-${n}-circle`}),c=new o.Text({text:s,x:i-5,y:r-7,fontSize:18,name:`beeper-${t}-${n}-text`});e.add(d,c)};class h{constructor(e){Object.assign(this,e),this.points=[],this.trace_enabled=!1,this.traceColor="black",this.trace=null,this.pending_moves=[],this.delay=.2,this.angle=0,this.rotation_diff={0:{x:-15,y:-15},"-90":{x:-15,y:15},"-180":{x:15,y:15},"-270":{x:15,y:-15}}}set_image(e,t){return new Promise(((n,i)=>{let r=this;new o.Image.fromURL(e,(function(i){r.src=e,r.set_node(i),i.setAttrs({x:100,y:100,width:32,height:32,name:`robot-${t}`}),r.layer.add(i),r.layer.batchDraw(),n(r)}))}))}set_node(e){for(this.node=e;this.pending_moves.length>0;){let[e,t]=this.pending_moves.shift();this.move_to(e,t)}}add_point(e,t){this.points=this.points.concat([e,t])}clear_trace(){this.points=[],this.angle=0,this.line_layer.destroyChildren(),this.line_layer.draw()}enable_trace(){this.trace_enabled=!0}draw_trace(){let e=new o.Line({points:this.points.slice(Math.max(this.points.length-4,0)),stroke:this.traceColor});this.line_layer.add(e),this.line_layer.draw()}rotate_left(){this.node.rotate(-90),this.angle=(this.angle-90)%-360,this.line_layer.draw()}move_to(e,t){if(!this.node)return void this.pending_moves.push([e,t]);let n=this;return new Promise((function(i,r){let a=n.rotation_diff[`${n.angle}`];var s=new o.Animation((function(i){n.node.x(e+a.x),n.node.y(t+a.y)}),n.layer);s.start(),setTimeout(i,1e3*n.delay);let l=n.node.position();l.x===e+a.x&&l.y===e+a.y&&s.stop()})).then((e=>console.log("done",n.delay)))}}var u=i.DOMWidgetView.extend({method_changed:function(){let e=JSON.parse(this.model.get("current_call"));s.add((()=>{let t="function"==typeof this[e.method_name]?this[e.method_name].apply(this,e.params):null;console.log("current_call in promise",e);let n=this;return Promise.resolve(t).then((function(t){let i=JSON.stringify({value:t,cb:+new Date,params:e.params,method:e.method_name});return console.log("setting return",i),n.model.set("method_return",i),n.model.save_changes(),i}))}))},render:function(){this._elem=document.createElement("div"),this._wrapper=document.createElement("div"),this._wrapper.setAttribute("class","ttgt-wrapper"),this._sidebar=document.createElement("button");let e=document.createElement("span"),t=document.createTextNode("Toggle");e.appendChild(t),e.setAttribute("class","bttn-txt"),this._sidebar.onclick=function(){$("#container").toggle()},this._sidebar.appendChild(e),this._sidebar.setAttribute("class","ttgt-sidebar-bttn"),this._wrapper.appendChild(this._elem),this._wrapper.appendChild(this._sidebar),console.log("ðŸš€ ~ file: maze.js ~ line 218 ~ this._elem",this),this._elem.setAttribute("id","container"),this.layer=new o.Layer,this.line_layer=new o.Layer,this.msg_layer=new o.Layer,this.robots=[],this.el.appendChild(this._wrapper),this.method_changed(),this.listenTo(this.model,"change:current_call",this.method_changed,this)},add_robot:function(e,t,n,i,r,o){let a=this.robots[e];return a&&a.node&&a.node.destroy(),this.robots[e]=new h({layer:this.layer,line_layer:this.line_layer,avenue:n,street:i,orientation:r,beepers:o,src:t}),this.robots[e].set_image(t,e).then((e=>{console.log(e)}))},move_to:function(e,t,n){return this.robots[e].move_to(t,n)},add_point:function(e,t,n){let i=this.robots[e];i&&(i.add_point(t,n),i.draw_trace())},remove_trace:function(e){let t=this.robots[e];t.trace_enabled=!1,t.clear_trace()},set_pause:function(e,t){console.log("pause");let n=this.robots[e];return n&&(n.delay=t),Promise.resolve(t)},set_trace:function(e,t,n,i="blue"){let r=this.robots[e];r.enable_trace(),r.traceColor=i,r.add_point(t,n)},init_robot:function(e){let t=this.robots[e];if(this.delete_msg(),t){for(;0!==t.angle;)t.rotate_left();t.clear_trace()}},add_beeper:function(e,t,n,i,r){c(this.layer,e,t,n,i,this.ts,r)},update_beeper:function(e,t,n){this.layer.find(`.beeper-${e}-${t}-text`).text(n),this.layer.draw()},remove_beeper:function(e,t){let n=this.layer.find(`.beeper-${e}-${t}-circle`),i=this.layer.find(`.beeper-${e}-${t}-text`);n&&n.destroy(),i&&i.destroy(),this.layer.draw()},add_flag:function(e,t,n,i){d(this.layer,e,t,n,i)},remove_flag:function(e,t){let n=this.layer.find(`.flag-${e}-${t}`);n&&n.destroy(),this.layer.draw()},rotate_left:function(e){this.robots[e].rotate_left()},success_msg:function(e){this.delete_msg();let t=new o.Group({opacity:0,name:"overlay-msg"});var n=new o.Rect({x:60,y:125,width:400,height:200,fill:"white",shadowBlur:10,cornerRadius:10}),i=new o.Circle({radius:40,x:260,y:130,fill:"green",stroke:"green",strokeWidth:5}),r=new o.Text({x:240,y:110,text:"âœ”",align:"center",fontSize:50,fontFamily:"Calibri",fill:"white"});e=new o.Text({x:120,y:200,text:"Congrats, \n Task Completed.",align:"center",fontSize:40,fontFamily:"Calibri",fill:"green"}),t.add(n,i,e,r),this.msg_layer.add(t),new o.Tween({node:t,opacity:1,easing:o.Easings.EaseOut,duration:5}).play()},delete_msg:function(){let e=this.msg_layer.find(".overlay-msg");e&&(e.destroy(),e.draw())},failed_msg:function(e){this.delete_msg();let t=new o.Group({opacity:0,name:"overlay-msg"});var n=new o.Rect({x:60,y:125,width:400,height:200,fill:"white",shadowBlur:10,cornerRadius:10}),i=new o.Circle({radius:40,x:260,y:130,fill:"red",stroke:"red",align:"center",strokeWidth:5}),r=new o.Text({x:247,y:102,text:"x",align:"center",fontSize:50,fontFamily:"Calibri",fill:"white"});e=new o.Text({x:120,y:200,text:"Opps, Task Failed.",align:"center",fontSize:40,fontFamily:"Calibri",fill:"red"}),t.add(n,i,e,r),this.msg_layer.add(t),new o.Tween({node:t,opacity:1,easing:o.Easings.EaseOut,duration:5,onFinish:()=>setTimeout((()=>{this.delete_msg()}),1e3)}).play()},draw_grid:function(e,t,n,i,r,a,s,l){this._width=e,this._heigth=t,this.stage=new o.Stage({container:"container",width:e,height:t}),this.stage.add(this.layer),this.stage.add(this.line_layer),this.stage.add(this.msg_layer),this.ts=r;let h=2*r,u=h+2*r*n,f=t-2*r,p=f-2*r*i;!function(e,t,n,i,r,a){for(let s=1;s<t;s++){let t=i+n*(2*s),l=new o.Line({stroke:"gray",points:[t,a,t,r]}),d=new o.Text({text:s,x:t-2,y:r+n-10});e.add(l),e.add(d)}}(this.layer,n,r,h,f,p),function(e,t,n,i,r,a){for(let s=1;s<t;s++){let t=r-n*(2*s),l=new o.Line({stroke:"gray",points:[i,t,a,t]}),d=new o.Text({text:s,y:t-2,x:i-n+5});e.add(l),e.add(d)}}(this.layer,i,r,h,f,u);let m=new o.Line({stroke:"darkred",points:[h,f,u,f,u,p,h,p],strokeWidth:10,closed:!0});return this.layer.add(m),function(e,t,n,i,r){const a=function(e,t){return[n+r*e,i-r*t]};t.map((function([t,n]){let i=[];i=t%2==0?[...a(t,n-1),...a(t,n+1)]:[...a(t-1,n),...a(t+1,n)];let r=new o.Line({stroke:"darkred",strokeWidth:10,closed:!0,points:i});e.add(r)}))}(this.layer,a,h,f,r),function(e,t,n,i,r){t.map((function(t){let o=t.key[0],a=t.key[1];const[s,l]=[n+r*(2*o-1),i-r*(2*a-1)];let d=t.value;c(e,o,a,s,l,r,d)}))}(this.layer,s,h,f,r),function(e,t,n,i,r){t.map((function(t){let o=t[0],a=t[1];const[s,l]=[n+r*(2*o-1),i-r*(2*a-1)];d(e,o,a,s,l)}))}(this.layer,l,h,f,r),this.layer.draw(),Promise.resolve("done")}});e.exports={MazeModel:l,MazeView:u}},1367:(e,t,n)=>{var i=n(7795);e.exports={...i}},2338:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(3645),r=n.n(i)()((function(e){return e[1]}));r.push([e.id,"#container {\n\tposition: fixed;\n\tright: 0;\n\tbottom: 0;\n\tmin-width: 550px;\n\tbackground-color: #f8f5e1;\n\tborder-left: 1px solid #aaa;\n\tborder-top: 1px solid #aaa;\n\tz-index: 105;\n}\n\n.bttn-txt {\n\t-webkit-transform: rotate(90deg);\n\t-moz-transform: rotate(90deg);\n\t-ms-transform: rotate(90deg);\n\t-o-transform: rotate(90deg);\n\ttransform: rotate(90deg);\n\twidth: 100%;\n\tdisplay: inline-block;\n}\n\n.ttgt-sidebar-bttn {\n\tposition: fixed;\n\tright: 0;\n\tbottom: 0;\n\twidth: 40px;\n\tbackground-color: #f8f5e1;\n\n\tz-index: 105;\n\theight: 500px;\n}\n\n.ttgt-wrapper {\n\tposition: absolute;\n\tright: 0;\n\tbottom: 0;\n\tbackground-color: #f8f5e1;\n\tborder-left: 1px solid #aaa;\n\tborder-top: 1px solid #aaa;\n\tz-index: 105;\n}\n\n.hide {\n\tdisplay: none;\n}\n\n.show {\n\tdisplay: inherit;\n}\n",""]);const o=r},3645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,i){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(i)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(r[a]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);i&&r[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),t.push(l))}},t}},4840:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var i=n(3379),r=n.n(i),o=n(2338);r()(o.Z,{insert:"head",singleton:!1});const a=o.Z.locals||{}},3379:(e,t,n)=>{"use strict";var i,r=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),o=[];function a(e){for(var t=-1,n=0;n<o.length;n++)if(o[n].identifier===e){t=n;break}return t}function s(e,t){for(var n={},i=[],r=0;r<e.length;r++){var s=e[r],l=t.base?s[0]+t.base:s[0],d=n[l]||0,c="".concat(l," ").concat(d);n[l]=d+1;var h=a(c),u={css:s[1],media:s[2],sourceMap:s[3]};-1!==h?(o[h].references++,o[h].updater(u)):o.push({identifier:c,updater:m(u,t),references:1}),i.push(c)}return i}function l(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var o=n.nc;o&&(i.nonce=o)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var a=r(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var d,c=(d=[],function(e,t){return d[e]=t,d.filter(Boolean).join("\n")});function h(e,t,n,i){var r=n?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=c(t,r);else{var o=document.createTextNode(r),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function u(e,t,n){var i=n.css,r=n.media,o=n.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var f=null,p=0;function m(e,t){var n,i,r;if(t.singleton){var o=p++;n=f||(f=l(t)),i=h.bind(null,n,o,!1),r=h.bind(null,n,o,!0)}else n=l(t),i=u.bind(null,n,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i));var n=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<n.length;i++){var r=a(n[i]);o[r].references--}for(var l=s(e,t),d=0;d<n.length;d++){var c=a(n[d]);0===o[c].references&&(o[c].updater(),o.splice(c,1))}n=l}}}},306:e=>{"use strict";e.exports={version:"0.3.1"}}}]);