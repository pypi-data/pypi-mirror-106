{"version":3,"sources":["webpack:///./app/components/acl/role.tsx","webpack:///./app/utils/isActiveSuperuser.tsx","webpack:///./app/components/events/eventAttachmentActions.tsx","webpack:///./app/components/fileSize.tsx","webpack:///./app/utils/attachmentUrl.tsx","webpack:///./app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsFilter.tsx","webpack:///./app/views/organizationGroupDetails/groupEventAttachments/types.tsx","webpack:///./app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsTableRow.tsx","webpack:///./app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsTable.tsx","webpack:///./app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachments.tsx","webpack:///./app/views/organizationGroupDetails/groupEventAttachments/index.tsx","webpack:///../node_modules/lodash/_baseDifference.js","webpack:///../node_modules/lodash/_baseXor.js","webpack:///../node_modules/lodash/xor.js"],"names":["Role","user","ConfigStore","this","props","organization","role","availableRoles","currentRole","isSuperuser","Cookies","undefined","Array","isArray","roleIds","map","r","id","includes","requiredIndex","indexOf","children","hasRole","isRenderFunc","React","withOrganization","EventAttachmentActions","api","url","onDelete","attachmentId","requestPromise","method","onPreview","withPreviewButton","hasPreview","previewIsOpen","gap","confirmText","t","message","priority","onConfirm","handleDelete","disabled","size","icon","label","title","DownloadButton","href","onClick","handlePreview","Component","Button","space","withApi","FileSize","className","bytes","getDynamicText","value","formatBytesBase2","fixed","AttachmentUrl","attachment","eventId","projectId","slug","attachmentsRole","getDownloadUrl","crashReportTypes","GroupEventAttachmentsFilter","location","query","pathname","types","allAttachmentsQuery","omit","onlyCrashReportsQuery","activeButton","xor","length","FilterWrapper","merged","active","barId","to","withRouter","GroupEventAttachmentsTableRow","isDeleted","orgId","groupId","TableRow","name","date","dateCreated","event_id","type","ActionsWrapper","p","GroupEventAttachmentsTable","attachments","deletedAttachments","tableRowNames","some","GroupEventAttachments","deletedAttachmentId","setState","prevState","params","pick","limit","renderBody","projectSlug","state","loading","eventAttachments","renderNoQueryResults","renderEmpty","Fragment","renderInnerBody","pageLinks","eventAttachmentsPageLinks","AsyncComponent","ReactRouter","GroupEventAttachmentsContainer","group","features","renderDisabled","project","SetCache","arrayIncludes","arrayIncludesWith","arrayMap","baseUnary","cacheHas","module","exports","array","values","iteratee","comparator","index","isCommon","result","valuesLength","outer","computed","valuesIndex","push","baseDifference","baseFlatten","baseUniq","arrays","othIndex","arrayFilter","baseRest","baseXor","isArrayLikeObject"],"mappings":"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","file":"app_views_organizationGroupDetails_groupEventAttachments_index_tsx.20ad64b44a302221ae86.js","sourcesContent":["import * as React from 'react';\n\nimport ConfigStore from 'app/stores/configStore';\nimport {Organization} from 'app/types';\nimport {isActiveSuperuser} from 'app/utils/isActiveSuperuser';\nimport {isRenderFunc} from 'app/utils/isRenderFunc';\nimport withOrganization from 'app/utils/withOrganization';\n\ntype RoleRenderProps = {\n  hasRole: boolean;\n};\n\ntype ChildrenRenderFn = (props: RoleRenderProps) => React.ReactNode;\n\ntype Props = {\n  /**\n   * Minimum required role\n   */\n  role: string;\n  /**\n   * Current Organization\n   */\n  organization: Organization;\n  /**\n   * If children is a function then will be treated as a render prop and\n   * passed RoleRenderProps.\n   *\n   * The other interface is more simple, only show `children` if user has\n   * the minimum required role.\n   */\n  children: React.ReactNode | ChildrenRenderFn;\n};\n\nclass Role extends React.Component<Props> {\n  hasRole() {\n    const user = ConfigStore.get('user');\n    const {organization, role} = this.props;\n    const {availableRoles} = organization;\n    const currentRole = organization.role ?? '';\n\n    if (!user) {\n      return false;\n    }\n\n    if (isActiveSuperuser()) {\n      return true;\n    }\n\n    if (!Array.isArray(availableRoles)) {\n      return false;\n    }\n\n    const roleIds = availableRoles.map(r => r.id);\n\n    if (!roleIds.includes(role) || !roleIds.includes(currentRole)) {\n      return false;\n    }\n\n    const requiredIndex = roleIds.indexOf(role);\n    const currentIndex = roleIds.indexOf(currentRole);\n    return currentIndex >= requiredIndex;\n  }\n\n  render() {\n    const {children} = this.props;\n    const hasRole = this.hasRole();\n\n    if (isRenderFunc<ChildrenRenderFn>(children)) {\n      return children({hasRole});\n    }\n\n    return hasRole && children ? children : null;\n  }\n}\n\nexport default withOrganization(Role);\n","import Cookies from 'js-cookie';\n\nimport ConfigStore from 'app/stores/configStore';\n\nconst SUPERUSER_COOKIE_NAME = 'su';\n\n/**\n * Checking for just isSuperuser on a config object may not be enough as backend often checks for *active* superuser.\n * We therefore check both isSuperuser flag AND superuser session cookie.\n */\nexport function isActiveSuperuser() {\n  const {isSuperuser} = ConfigStore.get('user') || {};\n\n  if (isSuperuser) {\n    /**\n     * Superuser cookie cannot be checked for existence as it is HttpOnly.\n     * As a workaround, we try to change it to something else and if that fails we can assume that it's being present.\n     * There may be an edgecase where it's present and expired but for current usage it's not a big deal.\n     */\n    Cookies.set(SUPERUSER_COOKIE_NAME, 'test');\n\n    if (Cookies.get(SUPERUSER_COOKIE_NAME) === undefined) {\n      return true;\n    }\n  }\n\n  return false;\n}\n","import {Component} from 'react';\nimport styled from '@emotion/styled';\n\nimport {Client} from 'app/api';\nimport Button from 'app/components/button';\nimport ButtonBar from 'app/components/buttonBar';\nimport Confirm from 'app/components/confirm';\nimport {IconDelete, IconDownload, IconShow} from 'app/icons';\nimport {t} from 'app/locale';\nimport space from 'app/styles/space';\nimport withApi from 'app/utils/withApi';\n\ntype Props = {\n  api: Client;\n  url: string | null;\n  attachmentId: string;\n  withPreviewButton?: boolean;\n  hasPreview?: boolean;\n  previewIsOpen?: boolean;\n  onDelete: (attachmentId: string) => void;\n  onPreview?: (attachmentId: string) => void;\n};\n\nclass EventAttachmentActions extends Component<Props> {\n  handleDelete = async () => {\n    const {api, url, onDelete, attachmentId} = this.props;\n\n    if (url) {\n      try {\n        await api.requestPromise(url, {\n          method: 'DELETE',\n        });\n\n        onDelete(attachmentId);\n      } catch (_err) {\n        // TODO: Error-handling\n      }\n    }\n  };\n\n  handlePreview() {\n    const {onPreview, attachmentId} = this.props;\n    if (onPreview) {\n      onPreview(attachmentId);\n    }\n  }\n\n  render() {\n    const {url, withPreviewButton, hasPreview, previewIsOpen} = this.props;\n\n    return (\n      <ButtonBar gap={1}>\n        <Confirm\n          confirmText={t('Delete')}\n          message={t('Are you sure you wish to delete this file?')}\n          priority=\"danger\"\n          onConfirm={this.handleDelete}\n          disabled={!url}\n        >\n          <Button\n            size=\"xsmall\"\n            icon={<IconDelete size=\"xs\" />}\n            label={t('Delete')}\n            disabled={!url}\n            title={!url ? t('Insufficient permissions to delete attachments') : undefined}\n          />\n        </Confirm>\n\n        <DownloadButton\n          size=\"xsmall\"\n          icon={<IconDownload size=\"xs\" />}\n          href={url ? `${url}?download=1` : ''}\n          disabled={!url}\n          title={!url ? t('Insufficient permissions to download attachments') : undefined}\n          label={t('Download')}\n        />\n\n        {withPreviewButton && (\n          <DownloadButton\n            size=\"xsmall\"\n            disabled={!url || !hasPreview}\n            priority={previewIsOpen ? 'primary' : 'default'}\n            icon={<IconShow size=\"xs\" />}\n            onClick={() => this.handlePreview()}\n            title={\n              !url\n                ? t('Insufficient permissions to preview attachments')\n                : !hasPreview\n                ? t('This attachment cannot be previewed')\n                : undefined\n            }\n          >\n            {t('Preview')}\n          </DownloadButton>\n        )}\n      </ButtonBar>\n    );\n  }\n}\n\nconst DownloadButton = styled(Button)`\n  margin-right: ${space(0.5)};\n`;\n\nexport default withApi(EventAttachmentActions);\n","import {formatBytesBase2} from 'app/utils';\nimport getDynamicText from 'app/utils/getDynamicText';\n\ntype Props = {\n  className?: string;\n  bytes: number;\n};\n\nfunction FileSize(props: Props) {\n  const {className, bytes} = props;\n\n  return (\n    <span className={className}>\n      {getDynamicText({value: formatBytesBase2(bytes), fixed: 'xx KB'})}\n    </span>\n  );\n}\n\nexport default FileSize;\n","import * as React from 'react';\n\nimport Role from 'app/components/acl/role';\nimport {EventAttachment, Organization} from 'app/types';\nimport withOrganization from 'app/utils/withOrganization';\n\ntype Props = {\n  organization: Organization;\n  projectId: string;\n  eventId: string;\n  attachment: EventAttachment;\n  children: (downloadUrl: string | null) => React.ReactNode;\n};\n\nclass AttachmentUrl extends React.PureComponent<Props> {\n  getDownloadUrl() {\n    const {attachment, organization, eventId, projectId} = this.props;\n    return `/api/0/projects/${organization.slug}/${projectId}/events/${eventId}/attachments/${attachment.id}/`;\n  }\n\n  render() {\n    const {children, organization} = this.props;\n    return (\n      <Role role={organization.attachmentsRole}>\n        {({hasRole}) => children(hasRole ? this.getDownloadUrl() : null)}\n      </Role>\n    );\n  }\n}\n\nexport default withOrganization(AttachmentUrl);\n","import {withRouter} from 'react-router';\nimport {WithRouterProps} from 'react-router/lib/withRouter';\nimport styled from '@emotion/styled';\nimport omit from 'lodash/omit';\nimport xor from 'lodash/xor';\n\nimport Button from 'app/components/button';\nimport ButtonBar from 'app/components/buttonBar';\nimport {t} from 'app/locale';\nimport space from 'app/styles/space';\n\nconst crashReportTypes = ['event.minidump', 'event.applecrashreport'];\n\nconst GroupEventAttachmentsFilter = (props: WithRouterProps) => {\n  const {query, pathname} = props.location;\n  const {types} = query;\n  const allAttachmentsQuery = omit(query, 'types');\n  const onlyCrashReportsQuery = {\n    ...query,\n    types: crashReportTypes,\n  };\n\n  let activeButton = '';\n\n  if (types === undefined) {\n    activeButton = 'all';\n  } else if (xor(crashReportTypes, types).length === 0) {\n    activeButton = 'onlyCrash';\n  }\n\n  return (\n    <FilterWrapper>\n      <ButtonBar merged active={activeButton}>\n        <Button barId=\"all\" size=\"small\" to={{pathname, query: allAttachmentsQuery}}>\n          {t('All Attachments')}\n        </Button>\n        <Button\n          barId=\"onlyCrash\"\n          size=\"small\"\n          to={{pathname, query: onlyCrashReportsQuery}}\n        >\n          {t('Only Crash Reports')}\n        </Button>\n      </ButtonBar>\n    </FilterWrapper>\n  );\n};\n\nconst FilterWrapper = styled('div')`\n  display: flex;\n  justify-content: flex-end;\n  margin-bottom: ${space(3)};\n`;\n\nexport {crashReportTypes};\nexport default withRouter(GroupEventAttachmentsFilter);\n","import {t} from 'app/locale';\n\nexport const types = {\n  'event.minidump': t('Minidump'),\n  'event.applecrashreport': t('Apple Crash Report'),\n  'event.attachment': t('Other'),\n};\n","import styled from '@emotion/styled';\n\nimport DateTime from 'app/components/dateTime';\nimport EventAttachmentActions from 'app/components/events/eventAttachmentActions';\nimport FileSize from 'app/components/fileSize';\nimport Link from 'app/components/links/link';\nimport {t} from 'app/locale';\nimport {EventAttachment} from 'app/types';\nimport AttachmentUrl from 'app/utils/attachmentUrl';\nimport {types} from 'app/views/organizationGroupDetails/groupEventAttachments/types';\n\ntype Props = {\n  orgId: string;\n  projectId: string;\n  groupId: string;\n  attachment: EventAttachment;\n  onDelete: (attachmentId: string) => void;\n  isDeleted: boolean;\n};\n\nconst GroupEventAttachmentsTableRow = ({\n  attachment,\n  projectId,\n  onDelete,\n  isDeleted,\n  orgId,\n  groupId,\n}: Props) => (\n  <TableRow isDeleted={isDeleted}>\n    <td>\n      <h5>\n        {attachment.name}\n        <br />\n        <small>\n          <DateTime date={attachment.dateCreated} /> &middot;{' '}\n          <Link\n            to={`/organizations/${orgId}/issues/${groupId}/events/${attachment.event_id}/`}\n          >\n            {attachment.event_id}\n          </Link>\n        </small>\n      </h5>\n    </td>\n\n    <td>{types[attachment.type] || t('Other')}</td>\n\n    <td>\n      <FileSize bytes={attachment.size} />\n    </td>\n\n    <td>\n      <ActionsWrapper>\n        <AttachmentUrl\n          projectId={projectId}\n          eventId={attachment.event_id}\n          attachment={attachment}\n        >\n          {url =>\n            !isDeleted && (\n              <EventAttachmentActions\n                url={url}\n                onDelete={onDelete}\n                attachmentId={attachment.id}\n              />\n            )\n          }\n        </AttachmentUrl>\n      </ActionsWrapper>\n    </td>\n  </TableRow>\n);\n\nconst TableRow = styled('tr')<{isDeleted: boolean}>`\n  opacity: ${p => (p.isDeleted ? 0.3 : 1)};\n  td {\n    text-decoration: ${p => (p.isDeleted ? 'line-through' : 'normal')};\n  }\n`;\n\nconst ActionsWrapper = styled('div')`\n  display: inline-block;\n`;\n\nexport default GroupEventAttachmentsTableRow;\n","import {t} from 'app/locale';\nimport {EventAttachment} from 'app/types';\nimport GroupEventAttachmentsTableRow from 'app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsTableRow';\n\ntype Props = {\n  attachments: EventAttachment[];\n  orgId: string;\n  projectId: string;\n  groupId: string;\n  onDelete: (attachmentId: string) => void;\n  deletedAttachments: string[];\n};\n\nconst GroupEventAttachmentsTable = ({\n  attachments,\n  orgId,\n  projectId,\n  groupId,\n  onDelete,\n  deletedAttachments,\n}: Props) => {\n  const tableRowNames = [t('Name'), t('Type'), t('Size'), t('Actions')];\n\n  return (\n    <table className=\"table events-table\">\n      <thead>\n        <tr>\n          {tableRowNames.map(name => (\n            <th key={name}>{name}</th>\n          ))}\n        </tr>\n      </thead>\n      <tbody>\n        {attachments.map(attachment => (\n          <GroupEventAttachmentsTableRow\n            key={attachment.id}\n            attachment={attachment}\n            orgId={orgId}\n            projectId={projectId}\n            groupId={groupId}\n            onDelete={onDelete}\n            isDeleted={deletedAttachments.some(id => attachment.id === id)}\n          />\n        ))}\n      </tbody>\n    </table>\n  );\n};\n\nexport default GroupEventAttachmentsTable;\n","import {Fragment} from 'react';\nimport * as ReactRouter from 'react-router';\nimport pick from 'lodash/pick';\n\nimport AsyncComponent from 'app/components/asyncComponent';\nimport EmptyStateWarning from 'app/components/emptyStateWarning';\nimport LoadingIndicator from 'app/components/loadingIndicator';\nimport Pagination from 'app/components/pagination';\nimport {Panel, PanelBody} from 'app/components/panels';\nimport {t} from 'app/locale';\n\nimport GroupEventAttachmentsFilter from './groupEventAttachmentsFilter';\nimport GroupEventAttachmentsTable from './groupEventAttachmentsTable';\n\ntype Props = {\n  projectSlug: string;\n} & ReactRouter.WithRouterProps &\n  AsyncComponent['props'];\n\ntype State = {\n  deletedAttachments: string[];\n} & AsyncComponent['state'];\n\nclass GroupEventAttachments extends AsyncComponent<Props, State> {\n  getDefaultState() {\n    return {\n      ...super.getDefaultState(),\n      deletedAttachments: [],\n    };\n  }\n\n  getEndpoints(): ReturnType<AsyncComponent['getEndpoints']> {\n    const {params, location} = this.props;\n\n    return [\n      [\n        'eventAttachments',\n        `/issues/${params.groupId}/attachments/`,\n        {\n          query: {\n            ...pick(location.query, ['cursor', 'environment', 'types']),\n            limit: 50,\n          },\n        },\n      ],\n    ];\n  }\n\n  handleDelete = (deletedAttachmentId: string) => {\n    this.setState(prevState => ({\n      deletedAttachments: [...prevState.deletedAttachments, deletedAttachmentId],\n    }));\n  };\n\n  renderNoQueryResults() {\n    return (\n      <EmptyStateWarning>\n        <p>{t('Sorry, no event attachments match your search query.')}</p>\n      </EmptyStateWarning>\n    );\n  }\n\n  renderEmpty() {\n    return (\n      <EmptyStateWarning>\n        <p>{t(\"There don't seem to be any event attachments yet.\")}</p>\n      </EmptyStateWarning>\n    );\n  }\n\n  renderLoading() {\n    return this.renderBody();\n  }\n\n  renderInnerBody() {\n    const {projectSlug, params, location} = this.props;\n    const {loading, eventAttachments, deletedAttachments} = this.state;\n\n    if (loading) {\n      return <LoadingIndicator />;\n    }\n\n    if (eventAttachments.length > 0) {\n      return (\n        <GroupEventAttachmentsTable\n          attachments={eventAttachments}\n          orgId={params.orgId}\n          projectId={projectSlug}\n          groupId={params.groupId}\n          onDelete={this.handleDelete}\n          deletedAttachments={deletedAttachments}\n        />\n      );\n    }\n\n    if (location.query.types) {\n      return this.renderNoQueryResults();\n    }\n\n    return this.renderEmpty();\n  }\n\n  renderBody() {\n    return (\n      <Fragment>\n        <GroupEventAttachmentsFilter />\n        <Panel className=\"event-list\">\n          <PanelBody>{this.renderInnerBody()}</PanelBody>\n        </Panel>\n        <Pagination pageLinks={this.state.eventAttachmentsPageLinks} />\n      </Fragment>\n    );\n  }\n}\n\nexport default ReactRouter.withRouter(GroupEventAttachments);\n","import {RouteComponentProps} from 'react-router';\n\nimport Feature from 'app/components/acl/feature';\nimport FeatureDisabled from 'app/components/acl/featureDisabled';\nimport {Group, Organization} from 'app/types';\nimport withOrganization from 'app/utils/withOrganization';\n\nimport GroupEventAttachments from './groupEventAttachments';\n\ntype Props = RouteComponentProps<{orgId: string; groupId: string}, {}> & {\n  organization: Organization;\n  group: Group;\n};\n\nconst GroupEventAttachmentsContainer = ({organization, group}: Props) => (\n  <Feature\n    features={['event-attachments']}\n    organization={organization}\n    renderDisabled={props => <FeatureDisabled {...props} />}\n  >\n    <GroupEventAttachments projectSlug={group.project.slug} />\n  </Feature>\n);\n\nexport default withOrganization(GroupEventAttachmentsContainer);\n","var SetCache = require('./_SetCache'),\n    arrayIncludes = require('./_arrayIncludes'),\n    arrayIncludesWith = require('./_arrayIncludesWith'),\n    arrayMap = require('./_arrayMap'),\n    baseUnary = require('./_baseUnary'),\n    cacheHas = require('./_cacheHas');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of methods like `_.difference` without support\n * for excluding multiple arrays or iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Array} values The values to exclude.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of filtered values.\n */\nfunction baseDifference(array, values, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      isCommon = true,\n      length = array.length,\n      result = [],\n      valuesLength = values.length;\n\n  if (!length) {\n    return result;\n  }\n  if (iteratee) {\n    values = arrayMap(values, baseUnary(iteratee));\n  }\n  if (comparator) {\n    includes = arrayIncludesWith;\n    isCommon = false;\n  }\n  else if (values.length >= LARGE_ARRAY_SIZE) {\n    includes = cacheHas;\n    isCommon = false;\n    values = new SetCache(values);\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee == null ? value : iteratee(value);\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var valuesIndex = valuesLength;\n      while (valuesIndex--) {\n        if (values[valuesIndex] === computed) {\n          continue outer;\n        }\n      }\n      result.push(value);\n    }\n    else if (!includes(values, computed, comparator)) {\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseDifference;\n","var baseDifference = require('./_baseDifference'),\n    baseFlatten = require('./_baseFlatten'),\n    baseUniq = require('./_baseUniq');\n\n/**\n * The base implementation of methods like `_.xor`, without support for\n * iteratee shorthands, that accepts an array of arrays to inspect.\n *\n * @private\n * @param {Array} arrays The arrays to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of values.\n */\nfunction baseXor(arrays, iteratee, comparator) {\n  var length = arrays.length;\n  if (length < 2) {\n    return length ? baseUniq(arrays[0]) : [];\n  }\n  var index = -1,\n      result = Array(length);\n\n  while (++index < length) {\n    var array = arrays[index],\n        othIndex = -1;\n\n    while (++othIndex < length) {\n      if (othIndex != index) {\n        result[index] = baseDifference(result[index] || array, arrays[othIndex], iteratee, comparator);\n      }\n    }\n  }\n  return baseUniq(baseFlatten(result, 1), iteratee, comparator);\n}\n\nmodule.exports = baseXor;\n","var arrayFilter = require('./_arrayFilter'),\n    baseRest = require('./_baseRest'),\n    baseXor = require('./_baseXor'),\n    isArrayLikeObject = require('./isArrayLikeObject');\n\n/**\n * Creates an array of unique values that is the\n * [symmetric difference](https://en.wikipedia.org/wiki/Symmetric_difference)\n * of the given arrays. The order of result values is determined by the order\n * they occur in the arrays.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Array\n * @param {...Array} [arrays] The arrays to inspect.\n * @returns {Array} Returns the new array of filtered values.\n * @see _.difference, _.without\n * @example\n *\n * _.xor([2, 1], [2, 3]);\n * // => [1, 3]\n */\nvar xor = baseRest(function(arrays) {\n  return baseXor(arrayFilter(arrays, isArrayLikeObject));\n});\n\nmodule.exports = xor;\n"],"sourceRoot":""}