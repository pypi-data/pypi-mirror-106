(self.webpackChunk=self.webpackChunk||[]).push([["app_views_dashboardsV2_detail_tsx"],{"./app/views/dashboardsV2/data.tsx":(e,t,a)=>{"use strict";a.d(t,{R7:()=>o,L3:()=>r,GY:()=>i});var n=a("./app/locale.tsx"),o={id:"",dateCreated:"",createdBy:void 0,title:(0,n.t)("Untitled dashboard"),widgets:[]},r=[{label:(0,n.t)("Area Chart"),value:"area"},{label:(0,n.t)("Bar Chart"),value:"bar"},{label:(0,n.t)("Line Chart"),value:"line"},{label:(0,n.t)("Table"),value:"table"},{label:(0,n.t)("World Map"),value:"world_map"},{label:(0,n.t)("Big Number"),value:"big_number"}],i=((0,n.t)("1 Minute"),(0,n.t)("5 Minutes"),(0,n.t)("15 Minutes"),(0,n.t)("30 Minutes"),(0,n.t)("1 Hour"),(0,n.t)("1 Day"),"24h")},"./app/views/dashboardsV2/detail.tsx":(e,t,a)=>{"use strict";a.d(t,{Z:()=>Ce}),a("../node_modules/core-js/modules/es.reflect.construct.js"),a("../node_modules/core-js/modules/es.object.keys.js"),a("../node_modules/core-js/modules/es.symbol.js"),a("../node_modules/core-js/modules/es.array.filter.js"),a("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),a("../node_modules/core-js/modules/es.array.for-each.js"),a("../node_modules/core-js/modules/web.dom-collections.for-each.js"),a("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),a("../node_modules/core-js/modules/es.object.define-properties.js"),a("../node_modules/core-js/modules/es.object.define-property.js");var n=a("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),o=a("../node_modules/@babel/runtime/helpers/esm/createClass.js"),r=a("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),i=a("../node_modules/@babel/runtime/helpers/esm/inherits.js"),s=a("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),d=a("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=a("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),c=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),u=(a("../node_modules/core-js/modules/es.array.concat.js"),a("../node_modules/core-js/modules/es.parse-int.js"),a("../node_modules/core-js/modules/es.array.includes.js"),a("../node_modules/core-js/modules/es.string.includes.js"),a("../node_modules/core-js/modules/es.regexp.exec.js"),a("../node_modules/core-js/modules/es.string.replace.js"),a("../node_modules/react/index.js")),p=a("../node_modules/react-router/es/index.js"),h=a("../node_modules/lodash/isEqual.js"),b=a.n(h),g=a("./app/actionCreators/dashboards.tsx"),m=a("./app/actionCreators/indicator.tsx"),f=a("./app/components/breadcrumbs.tsx"),y=a("./app/components/layouts/thirds.tsx"),v=a("./app/components/lightWeightNoProjectMessage.tsx"),Z=a("./app/components/organizations/globalSelectionHeader/index.tsx"),D=a("./app/locale.tsx"),w=a("./app/styles/organization.tsx"),E=a("./app/styles/space.tsx"),j=a("./app/utils/analytics.tsx"),x=a("./app/utils/withApi.tsx"),S=a("./app/utils/withOrganization.tsx"),O=(a("../node_modules/core-js/modules/es.array.map.js"),a("./app/components/acl/feature.tsx")),C=a("./app/components/acl/featureDisabled.tsx"),z=a("./app/components/button.tsx"),_=a("./app/components/buttonBar.tsx"),k=a("./app/components/confirm.tsx"),P=a("./app/components/forms/selectControl.tsx"),W=a("./app/components/hovercard.tsx"),B=a("./app/icons/index.tsx"),R=a("./app/views/dashboardsV2/types.tsx"),I=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,l.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var U=function(e){(0,i.Z)(l,e);var t,a,r=(t=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,d.Z)(t);if(a){var o=(0,d.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,s.Z)(this,e)});function l(){return(0,n.Z)(this,l),r.apply(this,arguments)}return(0,o.Z)(l,[{key:"render",value:function(){var e=this.props,t=e.dashboardState,a=e.dashboards,n=e.dashboard,o=e.organization,r=e.onEdit,i=e.onCreate,s=e.onCancel,d=e.onCommit,l=e.onDelete,c=(0,I.tZ)(z.ZP,{"data-test-id":"dashboard-cancel",onClick:function(e){e.preventDefault(),s()},children:(0,D.t)("Cancel")});if([R.n.EDIT,R.n.PENDING_DELETE].includes(t))return(0,I.BX)(M,{gap:1,children:[c,(0,I.tZ)(k.Z,{priority:"danger",message:(0,D.t)("Are you sure you want to delete this dashboard?"),onConfirm:l,disabled:a.length<=1,children:(0,I.tZ)(z.ZP,{"data-test-id":"dashboard-delete",priority:"danger",children:(0,D.t)("Delete")})}),(0,I.tZ)(z.ZP,{"data-test-id":"dashboard-commit",onClick:function(e){e.preventDefault(),d()},priority:"primary",children:(0,D.t)("Save and Finish")})]},"edit-controls");if("create"===t)return(0,I.BX)(M,{gap:1,children:[c,(0,I.tZ)(z.ZP,{"data-test-id":"dashboard-commit",onClick:function(e){e.preventDefault(),d()},priority:"primary",children:(0,D.t)("Save and Finish")})]},"create-controls");var u=a.map((function(e){return{label:e.title,value:e}})),h=void 0;n?h={label:n.title,value:N(N({},n),{},{widgetDisplay:n.widgets.map((function(e){return e.displayType}))})}:u.length&&(h=u[0]);var b=o.features.includes("dashboards-edit")&&!o.features.includes("dashboards-manage")?(0,I.tZ)(q,{children:(0,I.tZ)(P.Z,{name:"parameter",placeholder:(0,D.t)("Select Dashboard"),options:u,value:h,onChange:function(e){var t=e.value;p.browserHistory.push({pathname:"/organizations/".concat(o.slug,"/dashboard/").concat(t.id,"/"),query:{}})}},"select")}):null,g=o.features.includes("dashboards-edit")&&!o.features.includes("dashboards-manage")?(0,I.tZ)(z.ZP,{"data-test-id":"dashboard-create",onClick:function(e){e.preventDefault(),i()},icon:(0,I.tZ)(B.N_,{size:"xs",isCircled:!0}),children:(0,D.t)("Create Dashboard")}):null;return(0,I.BX)(M,{gap:1,children:[b,g,(0,I.tZ)(A,{children:function(e){return(0,I.tZ)(z.ZP,{"data-test-id":"dashboard-edit",onClick:function(e){e.preventDefault(),r()},priority:"primary",icon:(0,I.tZ)(B.yl,{size:"xs"}),disabled:!e,children:(0,D.t)("Edit Dashboard")})}})]},"controls")}}]),l}(u.Component);U.displayName="Controls";var A=function(e){var t=e.children,a=(0,D.t)("Requires dashboard editing.");return(0,I.tZ)(O.Z,{hookName:"feature-disabled:dashboards-edit",features:["organizations:dashboards-edit"],renderDisabled:function(e){return(0,I.tZ)(W.ZP,{body:(0,I.tZ)(C.Z,{features:e.features,hideHelpToggle:!0,message:a,featureName:a}),children:e.children(e)})},children:function(e){var a=e.hasFeature;return t(a)}})};A.displayName="DashboardEditFeature";var q=(0,c.Z)("div",{target:"e78awt51"})("min-width:200px;font-size:",(function(e){return e.theme.fontSizeMedium}),";"),M=(0,c.Z)(_.Z,{target:"e78awt50"})("@media (max-width: ",(function(e){return e.theme.breakpoints[0]}),"){grid-auto-flow:row;grid-row-gap:",(0,E.Z)(1),";width:100%;}");const V=U;var L=a("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),X=(a("../node_modules/core-js/modules/es.array.splice.js"),a("../node_modules/core-js/modules/es.function.bind.js"),a("../node_modules/core-js/modules/es.array.index-of.js"),a("../node_modules/@dnd-kit/core/dist/core.esm.js")),Y=a("../node_modules/@dnd-kit/sortable/dist/sortable.esm.js"),G=a("./app/actionCreators/modal.tsx"),H=a("./app/actionCreators/tags.tsx"),F=a("./app/utils/withGlobalSelection.tsx"),K=a("./app/views/dashboardsV2/widget/utils.tsx"),J=a("../node_modules/framer-motion/dist/es/render/dom/motion.js");const Q=(0,c.Z)(J.E.div,{target:"ec3gecx0"})("position:relative;touch-action:manipulation;",(function(e){switch(e.displayType){case"big_number":return"\n          /* 2 cols */\n          grid-area: span 1 / span 2;\n\n          @media (min-width: ".concat(e.theme.breakpoints[0],") {\n            /* 4 cols */\n            grid-area: span 1 / span 1;\n          }\n\n          @media (min-width: ").concat(e.theme.breakpoints[3],") {\n            /* 6 and 8 cols */\n            grid-area: span 1 / span 2;\n          }\n        ");default:return"\n          /* 2, 4, 6 and 8 cols */\n          grid-area: span 2 / span 2;\n        "}}),";");var $="add-widget-button",ee={x:0,y:0,scaleX:1,scaleY:1};function te(e){var t=e.onAddWidget,a=e.onOpenWidgetBuilder,n=e.orgFeatures.includes("metrics")?a:t,o=(0,Y.nB)({disabled:!0,id:$,transition:null}),r=o.setNodeRef,i=o.transform;return(0,I.tZ)(Q,{ref:r,displayType:R.F.BIG_NUMBER,layoutId:$,style:{originX:0,originY:0},animate:i?{x:i.x,y:i.y,scaleX:null!=i&&i.scaleX&&i.scaleX<=1?i.scaleX:1,scaleY:null!=i&&i.scaleY&&i.scaleY<=1?i.scaleY:1}:ee,transition:{duration:.25},children:(0,I.tZ)(oe,{onClick:n,children:(0,I.tZ)(ne,{"data-test-id":"widget-add",onClick:n,icon:(0,I.tZ)(B.N_,{size:"lg",isCircled:!0,color:"inactive"})})})},"add")}te.displayName="AddWidget";const ae=te;var ne=(0,c.Z)(z.ZP,{target:"e1sxcph31"})({name:"6ayxgl",styles:"border:none;&,&:focus,&:active,&:hover{background:transparent;box-shadow:none;}"}),oe=(0,c.Z)("div",{target:"e1sxcph30"})("width:100%;height:110px;border:2px dashed ",(function(e){return e.theme.border}),";border-radius:",(function(e){return e.theme.borderRadius}),";display:flex;align-items:center;justify-content:center;cursor:",(function(e){return e.onClick?"pointer":""}),";"),re=a("./app/utils/theme.tsx"),ie=a("./app/views/dashboardsV2/widgetCard.tsx"),se={x:0,y:0,scaleX:1,scaleY:1,zIndex:"auto"};function de(e){var t=e.widget,a=e.dragId,n=e.isEditing,o=e.onDelete,r=e.onEdit,i=(0,Y.nB)({id:a,transition:null}),s=i.attributes,d=i.listeners,l=i.setNodeRef,c=i.transform,p=i.isDragging,h=i.isSorting;return(0,u.useEffect)((function(){if(p)return document.body.style.cursor="grabbing",function(){document.body.style.cursor=""}}),[p]),(0,I.tZ)(Q,{ref:l,displayType:t.displayType,layoutId:a,style:{originX:p?1:0,originY:0,boxShadow:p?re.ZP.dropShadowHeavy:"none",borderRadius:p?re.ZP.borderRadius:void 0},animate:c?{x:c.x,y:c.y,scaleX:null!=c&&c.scaleX&&c.scaleX<=1?c.scaleX:1,scaleY:null!=c&&c.scaleY&&c.scaleY<=1?c.scaleY:1,zIndex:p?re.ZP.zIndex.modal:"auto"}:se,transition:{duration:p?0:.25,easings:{type:"spring"}},children:(0,I.tZ)(ie.Z,{widget:t,isEditing:n,onDelete:o,onEdit:r,isSorting:h,hideToolbar:h,currentWidgetDragging:p,draggableProps:{attributes:s,listeners:d},showContextMenu:!0})})}de.displayName="SortableWidget";const le=de;function ce(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ue(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(a),!0).forEach((function(t){(0,l.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ce(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var pe=function(e){(0,i.Z)(u,e);var t,a,c=(t=u,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,d.Z)(t);if(a){var o=(0,d.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,s.Z)(this,e)});function u(){var e;(0,n.Z)(this,u);for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return e=c.call.apply(c,[this].concat(a)),(0,l.Z)((0,r.Z)(e),"handleStartAdd",(function(){var t=e.props,a=t.organization,n=t.dashboard,o=t.selection;(0,G.openAddDashboardWidgetModal)({organization:a,dashboard:n,selection:o,onAddWidget:e.handleAddComplete})})),(0,l.Z)((0,r.Z)(e),"handleOpenWidgetBuilder",(function(){var t=e.props,a=t.router,n=t.paramDashboardId,o=t.organization,r=t.location;n?a.push({pathname:"/organizations/".concat(o.slug,"/dashboard/").concat(n,"/widget/new/"),query:ue(ue({},r.query),{},{dataSet:K.qg.EVENTS})}):a.push({pathname:"/organizations/".concat(o.slug,"/dashboards/new/widget/new/"),query:ue(ue({},r.query),{},{dataSet:K.qg.EVENTS})})})),(0,l.Z)((0,r.Z)(e),"handleAddComplete",(function(t){e.props.onUpdate([].concat((0,L.Z)(e.props.dashboard.widgets),[t]))})),(0,l.Z)((0,r.Z)(e),"handleUpdateComplete",(function(t){return function(a){var n=(0,L.Z)(e.props.dashboard.widgets);n[t]=a,e.props.onUpdate(n)}})),(0,l.Z)((0,r.Z)(e),"handleDeleteWidget",(function(t){return function(){var a=(0,L.Z)(e.props.dashboard.widgets);a.splice(t,1),e.props.onUpdate(a)}})),(0,l.Z)((0,r.Z)(e),"handleEditWidget",(function(t,a){return function(){var n=e.props,o=n.organization,r=n.dashboard,i=n.selection,s=n.router,d=n.location,l=n.paramDashboardId,c=n.onSetWidgetToBeUpdated;if(o.features.includes("metrics")){if(c(t),l)return void s.push({pathname:"/organizations/".concat(o.slug,"/dashboard/").concat(l,"/widget/").concat(a,"/edit/"),query:ue(ue({},d.query),{},{dataSet:K.qg.EVENTS})});s.push({pathname:"/organizations/".concat(o.slug,"/dashboards/new/widget/").concat(a,"/edit/"),query:ue(ue({},d.query),{},{dataSet:K.qg.EVENTS})})}(0,G.openAddDashboardWidgetModal)({organization:o,dashboard:r,widget:t,selection:i,onAddWidget:e.handleAddComplete,onUpdateWidget:e.handleUpdateComplete(a)})}})),e}return(0,o.Z)(u,[{key:"componentDidMount",value:function(){this.props.isEditing&&this.fetchTags()}},{key:"componentDidUpdate",value:function(e){var t=this.props.isEditing;e.isEditing!==t&&t&&this.fetchTags()}},{key:"fetchTags",value:function(){var e=this.props,t=e.api,a=e.organization,n=e.selection;(0,H.QK)(t,a.slug,n)}},{key:"getWidgetIds",value:function(){return[].concat((0,L.Z)(this.props.dashboard.widgets.map((function(e,t){return ge(e,t)}))),[$])}},{key:"renderWidget",value:function(e,t){var a=this.props.isEditing,n=ge(e,t),o=n;return(0,I.tZ)(le,{widget:e,dragId:o,isEditing:a,onDelete:this.handleDeleteWidget(t),onEdit:this.handleEditWidget(e,t)},n)}},{key:"render",value:function(){var e=this,t=this.props,a=t.isEditing,n=t.onUpdate,o=t.dashboard.widgets,r=t.organization,i=this.getWidgetIds();return(0,I.tZ)(X.LB,{collisionDetection:X.pE,onDragEnd:function(e){var t=e.over,a=e.active.id,r=i.indexOf.bind(i),s=a?r(a):-1;if(t&&t.id!==$){var d=r(t.id);s!==d&&n((0,Y.Rp)(o,s,d))}},children:(0,I.tZ)(be,{children:(0,I.BX)(Y.Fo,{items:i,strategy:Y.U2,children:[o.map((function(t,a){return e.renderWidget(t,a)})),a&&(0,I.tZ)(ae,{orgFeatures:r.features,onAddWidget:this.handleStartAdd,onOpenWidgetBuilder:this.handleOpenWidgetBuilder})]})})})}}]),u}(u.Component);pe.displayName="Dashboard";const he=(0,x.Z)((0,F.Z)(pe));var be=(0,c.Z)("div",{target:"e1wa3gzn0"})("display:grid;grid-template-columns:repeat(2, minmax(0, 1fr));grid-auto-flow:row dense;grid-gap:",(0,E.Z)(2),";@media (min-width: ",(function(e){return e.theme.breakpoints[1]}),"){grid-template-columns:repeat(4, minmax(0, 1fr));}@media (min-width: ",(function(e){return e.theme.breakpoints[3]}),"){grid-template-columns:repeat(6, minmax(0, 1fr));}@media (min-width: ",(function(e){return e.theme.breakpoints[4]}),"){grid-template-columns:repeat(8, minmax(0, 1fr));}");function ge(e,t){return e.id?"".concat(e.id,"-index-").concat(t):"index-".concat(t)}var me=a("./app/views/dashboardsV2/data.tsx"),fe=a("./app/components/editableText.tsx");function ye(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ve(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(a),!0).forEach((function(t){(0,l.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ye(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ze(e){var t=e.dashboard,a=e.isEditing,n=e.organization,o=e.onUpdate;return(0,I.tZ)("div",{children:t?(0,I.tZ)(fe.Z,{isDisabled:!a,value:n.features.includes("dashboards-manage")&&"default-overview"===t.id?"Default Dashboard":t.title,onChange:function(e){return o(ve(ve({},t),{},{title:e}))},errorMessage:(0,D.t)("Please set a title for this dashboard"),successMessage:(0,D.t)("Dashboard title updated successfully")}):(0,D.t)("Dashboards")})}Ze.displayName="DashboardTitle";const De=(0,S.Z)(Ze);var we=a("./app/views/dashboardsV2/utils.tsx");function Ee(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function je(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(a),!0).forEach((function(t){(0,l.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ee(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var xe=(0,D.t)("You have unsaved changes, are you sure you want to leave?"),Se=function(e){(0,i.Z)(h,e);var t,a,c=(t=h,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,d.Z)(t);if(a){var o=(0,d.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,s.Z)(this,e)});function h(){var e;(0,n.Z)(this,h);for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return e=c.call.apply(c,[this].concat(a)),(0,l.Z)((0,r.Z)(e),"state",{dashboardState:e.props.initialState,modifiedDashboard:e.updateModifiedDashboard(e.props.initialState)}),(0,l.Z)((0,r.Z)(e),"onEdit",(function(){var t=e.props.dashboard;(0,j.ec)({eventKey:"dashboards2.edit.start",eventName:"Dashboards2: Edit start",organization_id:parseInt(e.props.organization.id,10)}),e.setState({dashboardState:R.n.EDIT,modifiedDashboard:(0,we.q)(t)})})),(0,l.Z)((0,r.Z)(e),"onRouteLeave",(function(){if(![R.n.VIEW,R.n.PENDING_DELETE].includes(e.state.dashboardState))return xe})),(0,l.Z)((0,r.Z)(e),"onUnload",(function(t){[R.n.VIEW,R.n.PENDING_DELETE].includes(e.state.dashboardState)||(t.preventDefault(),t.returnValue=xe)})),(0,l.Z)((0,r.Z)(e),"onCreate",(function(){var t=e.props,a=t.organization,n=t.location;(0,j.ec)({eventKey:"dashboards2.create.start",eventName:"Dashboards2: Create start",organization_id:parseInt(e.props.organization.id,10)}),p.browserHistory.replace({pathname:"/organizations/".concat(a.slug,"/dashboards/new/"),query:n.query})})),(0,l.Z)((0,r.Z)(e),"onDelete",(function(t){return function(){var a=e.props,n=a.api,o=a.organization,r=a.location;if(null!=t&&t.id){var i=e.state.dashboardState;e.setState({dashboardState:R.n.PENDING_DELETE},(function(){(0,g.iM)(n,o.slug,t.id).then((function(){(0,m.S9)((0,D.t)("Dashboard deleted")),(0,j.ec)({eventKey:"dashboards2.delete",eventName:"Dashboards2: Delete",organization_id:parseInt(e.props.organization.id,10)}),p.browserHistory.replace({pathname:"/organizations/".concat(o.slug,"/dashboards/"),query:r.query})})).catch((function(){e.setState({dashboardState:i})}))}))}}})),(0,l.Z)((0,r.Z)(e),"onCancel",(function(){var t=e.props,a=t.organization,n=t.location;if(t.params.dashboardId)return(0,j.ec)({eventKey:"dashboards2.edit.cancel",eventName:"Dashboards2: Edit cancel",organization_id:parseInt(e.props.organization.id,10)}),void e.setState({dashboardState:R.n.VIEW,modifiedDashboard:null});(0,j.ec)({eventKey:"dashboards2.create.cancel",eventName:"Dashboards2: Create cancel",organization_id:parseInt(e.props.organization.id,10)}),p.browserHistory.replace({pathname:"/organizations/".concat(a.slug,"/dashboards/"),query:n.query})})),(0,l.Z)((0,r.Z)(e),"onCommit",(function(){var t=e.props,a=t.api,n=t.organization,o=t.location,r=t.dashboard,i=t.reloadData,s=e.state,d=s.modifiedDashboard;switch(s.dashboardState){case R.n.CREATE:d&&(0,g.JR)(a,n.slug,d).then((function(t){(0,m.S9)((0,D.t)("Dashboard created")),(0,j.ec)({eventKey:"dashboards2.create.complete",eventName:"Dashboards2: Create complete",organization_id:parseInt(n.id,10)}),e.setState({dashboardState:R.n.VIEW,modifiedDashboard:null}),p.browserHistory.replace({pathname:"/organizations/".concat(n.slug,"/dashboard/").concat(t.id,"/"),query:je({},o.query)})}));break;case R.n.EDIT:if(d)return b()(r,d)?void e.setState({dashboardState:R.n.VIEW,modifiedDashboard:null}):void(0,g.Y)(a,n.slug,d).then((function(t){(0,m.S9)((0,D.t)("Dashboard updated")),(0,j.ec)({eventKey:"dashboards2.edit.complete",eventName:"Dashboards2: Edit complete",organization_id:parseInt(n.id,10)}),e.setState({dashboardState:R.n.VIEW,modifiedDashboard:null}),r&&t.id!==r.id?p.browserHistory.replace({pathname:"/organizations/".concat(n.slug,"/dashboard/").concat(t.id,"/"),query:je({},o.query)}):i&&i()}));e.setState({dashboardState:R.n.VIEW,modifiedDashboard:null});break;case R.n.VIEW:default:e.setState({dashboardState:R.n.VIEW,modifiedDashboard:null})}})),(0,l.Z)((0,r.Z)(e),"setModifiedDashboard",(function(t){e.setState({modifiedDashboard:t})})),(0,l.Z)((0,r.Z)(e),"onSetWidgetToBeUpdated",(function(t){e.setState({widgetToBeUpdated:t})})),(0,l.Z)((0,r.Z)(e),"onUpdateWidget",(function(t){null!==e.state.modifiedDashboard&&e.setState((function(e){return je(je({},e),{},{widgetToBeUpdated:void 0,modifiedDashboard:je(je({},e.modifiedDashboard),{},{widgets:t})})}),e.updateRouteAfterSavingWidget)})),e}return(0,o.Z)(h,[{key:"componentDidMount",value:function(){var e=this.props,t=e.route,a=e.router;this.checkStateRoute(),a.setRouteLeaveHook(t,this.onRouteLeave),window.addEventListener("beforeunload",this.onUnload)}},{key:"componentDidUpdate",value:function(e){e.location.pathname!==this.props.location.pathname&&this.checkStateRoute()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeunload",this.onUnload)}},{key:"checkStateRoute",value:function(){var e=this.props,t=e.router,a=e.organization,n=e.params.dashboardId,o="/organizations/".concat(a.slug,"/dashboard/").concat(n,"/");this.isWidgetBuilderRouter&&!this.isEditing&&t.replace(o),location.pathname===o&&this.state.widgetToBeUpdated&&this.onSetWidgetToBeUpdated(void 0)}},{key:"updateRouteAfterSavingWidget",value:function(){if(this.isWidgetBuilderRouter){var e=this.props,t=e.router,a=e.organization,n=e.params.dashboardId;if(n)return void t.replace("/organizations/".concat(a.slug,"/dashboard/").concat(n,"/"));t.replace("/organizations/".concat(a.slug,"/dashboards/new/"))}}},{key:"updateModifiedDashboard",value:function(e){var t=this.props.dashboard;switch(e){case R.n.CREATE:return(0,we.q)(me.R7);case R.n.EDIT:return(0,we.q)(t);default:return null}}},{key:"isEditing",get:function(){var e=this.state.dashboardState;return[R.n.EDIT,R.n.CREATE,R.n.PENDING_DELETE].includes(e)}},{key:"isWidgetBuilderRouter",get:function(){var e=this.props,t=e.location,a=e.params,n=e.organization,o=a.dashboardId;return["/organizations/".concat(n.slug,"/dashboards/new/widget/new/"),"/organizations/".concat(n.slug,"/dashboard/").concat(o,"/widget/new/")].includes(t.pathname)||this.isWidgetBuilderEditRouter}},{key:"isWidgetBuilderEditRouter",get:function(){var e=this.props,t=e.location,a=e.params,n=e.organization,o=a.dashboardId,r=a.widgetId;return["/organizations/".concat(n.slug,"/dashboards/new/widget/").concat(r,"/edit/"),"/organizations/".concat(n.slug,"/dashboard/").concat(o,"/widget/").concat(r,"/edit/")].includes(t.pathname)}},{key:"dashboardTitle",get:function(){var e=this.props.dashboard,t=this.state.modifiedDashboard;return t?t.title:e.title}},{key:"renderWidgetBuilder",value:function(e){var t=this.props.children,a=this.state,n=a.modifiedDashboard,o=a.widgetToBeUpdated;return(0,u.isValidElement)(t)?(0,u.cloneElement)(t,{dashboard:null!=n?n:e,onSave:this.onUpdateWidget,widget:o}):t}},{key:"renderDefaultDashboardDetail",value:function(){var e=this.props,t=e.organization,a=e.dashboard,n=e.dashboards,o=e.params,r=e.router,i=e.location,s=this.state,d=s.modifiedDashboard,l=s.dashboardState,c=o.dashboardId;return(0,I.tZ)(Z.Z,{skipLoadLastUsed:t.features.includes("global-views"),defaultSelection:{datetime:{start:null,end:null,utc:!1,period:me.GY}},children:(0,I.tZ)(w.JH,{children:(0,I.BX)(v.Z,{organization:t,children:[(0,I.BX)(Oe,{children:[(0,I.tZ)(De,{dashboard:null!=d?d:a,onUpdate:this.setModifiedDashboard,isEditing:this.isEditing}),(0,I.tZ)(V,{organization:t,dashboards:n,dashboard:a,onEdit:this.onEdit,onCreate:this.onCreate,onCancel:this.onCancel,onCommit:this.onCommit,onDelete:this.onDelete(a),dashboardState:l})]}),(0,I.tZ)(he,{paramDashboardId:c,dashboard:null!=d?d:a,organization:t,isEditing:this.isEditing,onUpdate:this.onUpdateWidget,onSetWidgetToBeUpdated:this.onSetWidgetToBeUpdated,router:r,location:i})]})})})}},{key:"renderDashboardDetail",value:function(){var e=this.props,t=e.organization,a=e.dashboard,n=e.dashboards,o=e.params,r=e.router,i=e.location,s=this.state,d=s.modifiedDashboard,l=s.dashboardState,c=o.dashboardId;return(0,I.tZ)(Z.Z,{skipLoadLastUsed:t.features.includes("global-views"),defaultSelection:{datetime:{start:null,end:null,utc:!1,period:me.GY}},children:(0,I.BX)(v.Z,{organization:t,children:[(0,I.BX)(y.h4,{children:[(0,I.BX)(y.oB,{children:[(0,I.tZ)(f.Z,{crumbs:[{label:(0,D.t)("Dashboards"),to:"/organizations/".concat(t.slug,"/dashboards/")},{label:l===R.n.CREATE?(0,D.t)("Create Dashboard"):t.features.includes("dashboards-manage")&&"default-overview"===a.id?"Default Dashboard":this.dashboardTitle}]}),(0,I.tZ)(y.Dx,{children:(0,I.tZ)(De,{dashboard:null!=d?d:a,onUpdate:this.setModifiedDashboard,isEditing:this.isEditing})})]}),(0,I.tZ)(y.kP,{children:(0,I.tZ)(V,{organization:t,dashboards:n,dashboard:a,onEdit:this.onEdit,onCreate:this.onCreate,onCancel:this.onCancel,onCommit:this.onCommit,onDelete:this.onDelete(a),dashboardState:l})})]}),(0,I.tZ)(y.uT,{children:(0,I.tZ)(y.or,{fullWidth:!0,children:(0,I.tZ)(he,{paramDashboardId:c,dashboard:null!=d?d:a,organization:t,isEditing:this.isEditing,onUpdate:this.onUpdateWidget,onSetWidgetToBeUpdated:this.onSetWidgetToBeUpdated,router:r,location:i})})})]})})}},{key:"render",value:function(){var e=this.props,t=e.organization,a=e.dashboard;return this.isEditing&&this.isWidgetBuilderRouter?this.renderWidgetBuilder(a):t.features.includes("dashboards-manage")&&t.features.includes("dashboards-edit")?this.renderDashboardDetail():this.renderDefaultDashboardDetail()}}]),h}(u.Component);Se.displayName="DashboardDetail";var Oe=(0,c.Z)("div",{target:"e1anno2f0"})("display:grid;grid-template-columns:minmax(0, 1fr);grid-row-gap:",(0,E.Z)(2),";align-items:center;font-size:",(function(e){return e.theme.headerFontSize}),";color:",(function(e){return e.theme.textColor}),";margin-bottom:",(0,E.Z)(2),";@media (min-width: ",(function(e){return e.theme.breakpoints[1]}),"){grid-template-columns:minmax(0, 1fr) max-content;grid-column-gap:",(0,E.Z)(2),";height:40px;}");const Ce=(0,x.Z)((0,S.Z)(Se))},"./app/views/dashboardsV2/widget/utils.tsx":(e,t,a)=>{"use strict";a.d(t,{FO:()=>o,qg:()=>r,hV:()=>d});var n,o,r,i=a("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=a("./app/locale.tsx");!function(e){e.AREA="area",e.BAR="bar",e.LINE="line",e.TABLE="table",e.WORLD_MAP="world_map",e.BIG_NUMBER="big_number",e.STACKED_AREA="stacked_area"}(o||(o={})),function(e){e.EVENTS="events",e.METRICS="metrics"}(r||(r={}));var d=(n={},(0,i.Z)(n,o.AREA,(0,s.t)("Area Chart")),(0,i.Z)(n,o.BAR,(0,s.t)("Bar Chart")),(0,i.Z)(n,o.LINE,(0,s.t)("Line Chart")),(0,i.Z)(n,o.TABLE,(0,s.t)("Table")),(0,i.Z)(n,o.WORLD_MAP,(0,s.t)("World Map")),(0,i.Z)(n,o.BIG_NUMBER,(0,s.t)("Big Number")),n)}}]);
//# sourceMappingURL=app_views_dashboardsV2_detail_tsx.js.map